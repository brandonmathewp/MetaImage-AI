<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MetaAI - Venice Image Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #000000;
            --bg-secondary: #0a0a0a;
            --bg-tertiary: #121212;
            --cyan-primary: #00ffff;
            --cyan-secondary: #00cccc;
            --cyan-dark: #008888;
            --text-primary: #ffffff;
            --text-secondary: #cccccc;
            --border-color: #00ffff33;
            --error-color: #ff4444;
            --success-color: #00ff88;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 1rem;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 2rem;
            padding: 1.5rem 0;
            border-bottom: 2px solid var(--cyan-primary);
        }

        h1 {
            font-size: clamp(1.8rem, 5vw, 2.5rem);
            color: var(--cyan-primary);
            text-shadow: 0 0 10px var(--cyan-primary);
            margin-bottom: 0.5rem;
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .api-key-section {
            background: var(--bg-secondary);
            padding: 1.5rem;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            margin-bottom: 2rem;
        }

        .input-group {
            margin-bottom: 1.5rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--cyan-primary);
            font-weight: 500;
            font-size: 0.95rem;
        }

        input[type="text"],
        input[type="password"],
        input[type="number"],
        textarea,
        select {
            width: 100%;
            padding: 0.875rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        input:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: var(--cyan-primary);
            box-shadow: 0 0 0 2px var(--cyan-primary)33;
        }

        textarea {
            resize: vertical;
            min-height: 100px;
            font-family: inherit;
        }

        button {
            padding: 0.875rem 1.5rem;
            background: linear-gradient(135deg, var(--cyan-primary), var(--cyan-secondary));
            color: var(--bg-primary);
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px var(--cyan-primary)66;
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .model-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .model-card {
            background: var(--bg-tertiary);
            padding: 1rem;
            border-radius: 8px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .model-card:hover {
            border-color: var(--cyan-secondary);
            transform: translateY(-2px);
        }

        .model-card.selected {
            border-color: var(--cyan-primary);
            background: var(--cyan-dark)22;
            box-shadow: 0 0 20px var(--cyan-primary)33;
        }

        .model-name {
            font-weight: 600;
            color: var(--cyan-primary);
            margin-bottom: 0.5rem;
        }

        .model-info {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .model-pricing {
            margin-top: 0.5rem;
            padding-top: 0.5rem;
            border-top: 1px solid var(--border-color);
            font-size: 0.8rem;
            color: var(--cyan-secondary);
        }

        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .aspect-ratio-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .aspect-btn {
            padding: 0.5rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.3s ease;
        }

        .aspect-btn:hover {
            border-color: var(--cyan-secondary);
        }

        .aspect-btn.active {
            background: var(--cyan-primary);
            color: var(--bg-primary);
            border-color: var(--cyan-primary);
            font-weight: 600;
        }

        .toggle-group {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .toggle {
            position: relative;
            width: 50px;
            height: 26px;
            background: var(--bg-tertiary);
            border-radius: 13px;
            cursor: pointer;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .toggle.active {
            background: var(--cyan-primary);
        }

        .toggle-slider {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            background: var(--text-primary);
            border-radius: 50%;
            transition: transform 0.3s ease;
        }

        .toggle.active .toggle-slider {
            transform: translateX(24px);
        }

        .advanced-settings {
            background: var(--bg-secondary);
            padding: 1.5rem;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 1.2rem;
            color: var(--cyan-primary);
            margin-bottom: 1rem;
            font-weight: 600;
        }

        .loading {
            text-align: center;
            color: var(--cyan-primary);
            padding: 2rem;
        }

        .spinner {
            border: 3px solid var(--bg-tertiary);
            border-top: 3px solid var(--cyan-primary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error-message {
            background: var(--error-color)22;
            border: 1px solid var(--error-color);
            color: var(--error-color);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            font-weight: 500;
        }

        .success-message {
            background: var(--success-color)22;
            border: 1px solid var(--success-color);
            color: var(--success-color);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            font-weight: 500;
        }

        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
        }

        .image-card {
            background: var(--bg-secondary);
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .image-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px var(--cyan-primary)33;
        }

        .image-card img {
            width: 100%;
            height: auto;
            display: block;
        }

        .image-info {
            padding: 1rem;
        }

        .image-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.75rem;
        }

        .image-actions button {
            flex: 1;
            padding: 0.5rem;
            font-size: 0.85rem;
        }

        .hidden {
            display: none;
        }

        .cost-estimate {
            background: var(--bg-tertiary);
            padding: 0.75rem;
            border-radius: 6px;
            border: 1px solid var(--cyan-primary)44;
            margin-top: 0.5rem;
            font-size: 0.9rem;
        }

        .cost-label {
            color: var(--text-secondary);
        }

        .cost-value {
            color: var(--cyan-primary);
            font-weight: 600;
        }

        @media (max-width: 768px) {
            body {
                padding: 0.75rem;
            }

            .settings-grid {
                grid-template-columns: 1fr;
            }

            .model-selector {
                grid-template-columns: 1fr;
            }

            .aspect-ratio-buttons {
                grid-template-columns: repeat(3, 1fr);
            }

            .gallery {
                grid-template-columns: 1fr;
            }
        }

        .info-icon {
            display: inline-block;
            width: 16px;
            height: 16px;
            background: var(--cyan-primary);
            color: var(--bg-primary);
            border-radius: 50%;
            text-align: center;
            line-height: 16px;
            font-size: 12px;
            font-weight: bold;
            cursor: help;
            margin-left: 0.25rem;
        }

        .slider-container {
            margin-top: 0.5rem;
        }

        input[type="range"] {
            width: 100%;
            height: 6px;
            background: var(--bg-tertiary);
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            background: var(--cyan-primary);
            border-radius: 50%;
            cursor: pointer;
        }

        input[type="range"]::-moz-range-thumb {
            width: 18px;
            height: 18px;
            background: var(--cyan-primary);
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }

        .slider-value {
            display: inline-block;
            color: var(--cyan-primary);
            font-weight: 600;
            margin-left: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>MetaAI</h1>
            <p class="subtitle">Powered by Venice.ai API</p>
        </header>

        <div class="api-key-section">
            <div class="input-group">
                <label for="apiKey">Venice API Key <span class="info-icon" title="Get your API key from venice.ai/settings/api">?</span></label>
                <input type="password" id="apiKey" placeholder="Enter your Venice API key" />
            </div>
            <button id="loadModels">Load Models</button>
        </div>

        <div id="mainContent" class="hidden">
            <div class="advanced-settings">
                <h2 class="section-title">Model Selection</h2>
                <div id="modelSelector" class="model-selector">
                    <div class="loading">
                        <div class="spinner"></div>
                        <p>Loading models...</p>
                    </div>
                </div>
            </div>

            <div class="advanced-settings">
                <h2 class="section-title">Generation Settings</h2>
                
                <div class="input-group">
                    <label for="prompt">Prompt</label>
                    <textarea id="prompt" placeholder="Describe the image you want to generate..."></textarea>
                </div>

                <div class="input-group">
                    <label for="negativePrompt">Negative Prompt (Optional)</label>
                    <textarea id="negativePrompt" placeholder="What you don't want in the image..."></textarea>
                </div>

                <div class="settings-grid">
                    <div class="input-group">
                        <label>Aspect Ratio</label>
                        <div class="aspect-ratio-buttons">
                            <div class="aspect-btn active" data-ratio="1:1">1:1</div>
                            <div class="aspect-btn" data-ratio="16:9">16:9</div>
                            <div class="aspect-btn" data-ratio="9:16">9:16</div>
                            <div class="aspect-btn" data-ratio="4:3">4:3</div>
                            <div class="aspect-btn" data-ratio="3:4">3:4</div>
                            <div class="aspect-btn" data-ratio="custom">Custom</div>
                        </div>
                    </div>
                </div>

                <div id="customDimensions" class="hidden">
                    <div class="settings-grid">
                        <div class="input-group">
                            <label for="width">Width (px)</label>
                            <input type="number" id="width" value="1024" min="256" max="2048" step="64" />
                        </div>
                        <div class="input-group">
                            <label for="height">Height (px)</label>
                            <input type="number" id="height" value="1024" min="256" max="2048" step="64" />
                        </div>
                    </div>
                </div>

                <div class="settings-grid">
                    <div class="input-group">
                        <label for="variants">Number of Images (1-4)</label>
                        <input type="number" id="variants" value="1" min="1" max="4" />
                    </div>

                    <div class="input-group">
                        <label for="seed">Seed (Optional) <span class="info-icon" title="Use -1 for random seed">?</span></label>
                        <input type="number" id="seed" value="-1" />
                    </div>
                </div>

                <div class="settings-grid">
                    <div class="input-group">
                        <label for="cfgScale">
                            CFG Scale <span class="slider-value" id="cfgValue">7.5</span>
                            <span class="info-icon" title="How closely to follow the prompt">?</span>
                        </label>
                        <div class="slider-container">
                            <input type="range" id="cfgScale" min="1" max="20" step="0.5" value="7.5" />
                        </div>
                    </div>
                </div>

                <div class="input-group">
                    <label class="toggle-group">
                        <div class="toggle" id="safetyToggle">
                            <div class="toggle-slider"></div>
                        </div>
                        <span>Safe Mode (Blur NSFW content)</span>
                    </label>
                </div>

                <div id="costEstimate" class="cost-estimate hidden">
                    <span class="cost-label">Estimated Cost:</span>
                    <span class="cost-value" id="costValue">$0.00</span>
                </div>

                <button id="generateBtn">Generate Images</button>
            </div>

            <div id="errorContainer"></div>
            <div id="successContainer"></div>
            
            <div id="gallery" class="gallery"></div>
        </div>
    </div>

    <script>
        // State management
        const state = {
            apiKey: '',
            models: [],
            selectedModel: null,
            aspectRatio: '1:1',
            safeMode: false,
            generating: false
        };

        // DOM elements
        const elements = {
            apiKeyInput: document.getElementById('apiKey'),
            loadModelsBtn: document.getElementById('loadModels'),
            mainContent: document.getElementById('mainContent'),
            modelSelector: document.getElementById('modelSelector'),
            generateBtn: document.getElementById('generateBtn'),
            gallery: document.getElementById('gallery'),
            customDimensions: document.getElementById('customDimensions'),
            costEstimate: document.getElementById('costEstimate'),
            errorContainer: document.getElementById('errorContainer'),
            successContainer: document.getElementById('successContainer'),
            safetyToggle: document.getElementById('safetyToggle'),
            cfgScale: document.getElementById('cfgScale'),
            cfgValue: document.getElementById('cfgValue')
        };

        // Utility functions
        function showError(message) {
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error-message';
            errorDiv.style.cursor = 'pointer';
            errorDiv.textContent = message;
            errorDiv.title = 'Click to dismiss';
            errorDiv.addEventListener('click', () => errorDiv.remove());
            
            elements.errorContainer.innerHTML = '';
            elements.errorContainer.appendChild(errorDiv);
            console.error('Error:', message);
        }

        function showSuccess(message) {
            const successDiv = document.createElement('div');
            successDiv.className = 'success-message';
            successDiv.style.cursor = 'pointer';
            successDiv.textContent = message;
            successDiv.title = 'Click to dismiss';
            successDiv.addEventListener('click', () => successDiv.remove());
            
            elements.successContainer.innerHTML = '';
            elements.successContainer.appendChild(successDiv);
            console.log('Success:', message);
            
            setTimeout(() => {
                if (successDiv.parentNode) {
                    successDiv.remove();
                }
            }, 5000);
        }

        function getAspectRatioDimensions(ratio) {
            const dimensions = {
                '1:1': { width: 1024, height: 1024 },
                '16:9': { width: 1280, height: 720 },
                '9:16': { width: 720, height: 1280 },
                '4:3': { width: 1024, height: 768 },
                '3:4': { width: 768, height: 1024 }
            };
            return dimensions[ratio] || { width: 1024, height: 1024 };
        }

        // Event listeners
        elements.loadModelsBtn.addEventListener('click', loadModels);
        console.log('Load Models button listener attached');
        
        elements.generateBtn.addEventListener('click', generateImages);

        elements.safetyToggle.addEventListener('click', () => {
            state.safeMode = !state.safeMode;
            elements.safetyToggle.classList.toggle('active');
        });

        elements.cfgScale.addEventListener('input', (e) => {
            elements.cfgValue.textContent = e.target.value;
        });

        // Aspect ratio buttons
        document.querySelectorAll('.aspect-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.aspect-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                state.aspectRatio = btn.dataset.ratio;
                
                if (state.aspectRatio === 'custom') {
                    elements.customDimensions.classList.remove('hidden');
                } else {
                    elements.customDimensions.classList.add('hidden');
                    const dims = getAspectRatioDimensions(state.aspectRatio);
                    document.getElementById('width').value = dims.width;
                    document.getElementById('height').value = dims.height;
                }
                
                updateCostEstimate();
            });
        });

        // Load models from API
        async function loadModels() {
            console.log('Load Models button clicked!');
            
            const apiKey = elements.apiKeyInput.value.trim();
            
            if (!apiKey) {
                showError('Please enter your Venice API key');
                return;
            }

            state.apiKey = apiKey;
            elements.loadModelsBtn.disabled = true;
            elements.loadModelsBtn.textContent = 'Loading...';

            try {
                console.log('Fetching models from Venice API...');
                
                const response = await fetch('https://api.venice.ai/api/v1/models', {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${apiKey}`,
                        'Content-Type': 'application/json'
                    }
                });

                console.log('Response status:', response.status);

                if (!response.ok) {
                    const errorText = await response.text();
                    console.error('API Error:', errorText);
                    
                    if (response.status === 401) {
                        throw new Error('Invalid API key. Please check your key and try again.');
                    } else if (response.status === 429) {
                        throw new Error('Rate limit exceeded. Please wait a moment and try again.');
                    } else {
                        throw new Error(`Failed to load models: ${response.status} ${response.statusText}`);
                    }
                }

                const data = await response.json();
                console.log('Models data:', data);
                
                if (!data.data || !Array.isArray(data.data)) {
                    throw new Error('Invalid response format from API');
                }
                
                // Filter for image models only
                state.models = data.data.filter(model => model.type === 'image');
                console.log('Image models found:', state.models.length);
                
                if (state.models.length === 0) {
                    throw new Error('No image models available. Your API key may not have access to image generation.');
                }

                displayModels();
                elements.mainContent.classList.remove('hidden');
                showSuccess(`Successfully loaded ${state.models.length} image model(s)!`);
                
                // Store API key
                localStorage.setItem('veniceApiKey', apiKey);

            } catch (error) {
                console.error('Error loading models:', error);
                showError(error.message || 'An unexpected error occurred. Check the browser console for details.');
            } finally {
                elements.loadModelsBtn.disabled = false;
                elements.loadModelsBtn.textContent = 'Load Models';
            }
        }

        // Display models
        function displayModels() {
            elements.modelSelector.innerHTML = '';

            state.models.forEach((model, index) => {
                const card = document.createElement('div');
                card.className = 'model-card';
                if (index === 0) {
                    card.classList.add('selected');
                    state.selectedModel = model;
                }

                const spec = model.model_spec;
                const pricing = spec.pricing || {};

                card.innerHTML = `
                    <div class="model-name">${spec.name || model.id}</div>
                    <div class="model-info">
                        ${spec.description || 'No description available'}
                    </div>
                    ${pricing.generation ? `
                        <div class="model-pricing">
                            ðŸ’° ${pricing.generation.usd ? `$${pricing.generation.usd} USD` : 'Pricing varies'}
                            ${pricing.generation.diem ? ` | ${pricing.generation.diem} DIEM` : ''}
                        </div>
                    ` : ''}
                `;

                card.addEventListener('click', () => {
                    document.querySelectorAll('.model-card').forEach(c => c.classList.remove('selected'));
                    card.classList.add('selected');
                    state.selectedModel = model;
                    updateCostEstimate();
                });

                elements.modelSelector.appendChild(card);
            });

            updateCostEstimate();
        }

        // Update cost estimate
        function updateCostEstimate() {
            if (!state.selectedModel) return;

            const variants = parseInt(document.getElementById('variants').value) || 1;
            const pricing = state.selectedModel.model_spec.pricing;

            if (pricing && pricing.generation && pricing.generation.usd) {
                const cost = (pricing.generation.usd * variants).toFixed(4);
                elements.costEstimate.classList.remove('hidden');
                document.getElementById('costValue').textContent = `$${cost} USD`;
            } else {
                elements.costEstimate.classList.add('hidden');
            }
        }

        // Generate images
        async function generateImages() {
            if (!state.selectedModel) {
                showError('Please select a model');
                return;
            }

            const prompt = document.getElementById('prompt').value.trim();
            if (!prompt) {
                showError('Please enter a prompt');
                return;
            }

            if (state.generating) return;

            state.generating = true;
            elements.generateBtn.disabled = true;
            elements.generateBtn.textContent = 'Generating...';

            const params = {
                model: state.selectedModel.id,
                prompt: prompt,
                safe_mode: state.safeMode,
                cfg_scale: parseFloat(elements.cfgScale.value),
                variants: parseInt(document.getElementById('variants').value) || 1,
                return_binary: false
            };

            // Add negative prompt if provided
            const negativePrompt = document.getElementById('negativePrompt').value.trim();
            if (negativePrompt) {
                params.negative_prompt = negativePrompt;
            }

            // Add seed if not -1
            const seed = parseInt(document.getElementById('seed').value);
            if (seed !== -1) {
                params.seed = seed;
            }

            // Add dimensions
            if (state.aspectRatio === 'custom') {
                params.width = parseInt(document.getElementById('width').value);
                params.height = parseInt(document.getElementById('height').value);
            } else {
                params.aspect_ratio = state.aspectRatio;
                const dims = getAspectRatioDimensions(state.aspectRatio);
                params.width = dims.width;
                params.height = dims.height;
            }

            try {
                const response = await fetch('https://api.venice.ai/api/v1/image/generate', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${state.apiKey}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(params)
                });

                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.message || `Generation failed: ${response.statusText}`);
                }

                const data = await response.json();
                
                if (data.images && data.images.length > 0) {
                    displayImages(data.images, params);
                    showSuccess(`Generated ${data.images.length} image(s) successfully!`);
                } else {
                    throw new Error('No images returned');
                }

            } catch (error) {
                showError(error.message);
            } finally {
                state.generating = false;
                elements.generateBtn.disabled = false;
                elements.generateBtn.textContent = 'Generate Images';
            }
        }

        // Display generated images
        function displayImages(images, params) {
            images.forEach(imageData => {
                const card = document.createElement('div');
                card.className = 'image-card';

                // Check if imageData is base64 or URL
                const imageSrc = imageData.startsWith('http') ? imageData : `data:image/png;base64,${imageData}`;

                card.innerHTML = `
                    <img src="${imageSrc}" alt="Generated image" loading="lazy" />
                    <div class="image-info">
                        <div style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 0.5rem;">
                            Model: ${state.selectedModel.model_spec.name}
                        </div>
                        <div class="image-actions">
                            <button onclick="downloadImage('${imageSrc}')">Download</button>
                            <button onclick="copyPrompt(\`${params.prompt.replace(/`/g, '\\`')}\`)">Copy Prompt</button>
                        </div>
                    </div>
                `;

                elements.gallery.insertBefore(card, elements.gallery.firstChild);
            });
        }

        // Download image
        window.downloadImage = function(src) {
            const link = document.createElement('a');
            link.href = src;
            link.download = `metaai-${Date.now()}.png`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            showSuccess('Image download started!');
        };

        // Copy prompt
        window.copyPrompt = function(prompt) {
            navigator.clipboard.writeText(prompt).then(() => {
                showSuccess('Prompt copied to clipboard!');
            }).catch(() => {
                showError('Failed to copy prompt');
            });
        };

        // Load saved API key on page load
        window.addEventListener('DOMContentLoaded', () => {
            console.log('MetaAI Image Generator initialized');
            console.log('DOM elements found:', {
                apiKeyInput: !!elements.apiKeyInput,
                loadModelsBtn: !!elements.loadModelsBtn,
                mainContent: !!elements.mainContent,
                modelSelector: !!elements.modelSelector,
                generateBtn: !!elements.generateBtn
            });
            
            const savedKey = localStorage.getItem('veniceApiKey');
            if (savedKey) {
                elements.apiKeyInput.value = savedKey;
                console.log('Loaded saved API key from localStorage');
            }
        });

        // Update cost estimate when variants change
        document.getElementById('variants').addEventListener('input', updateCostEstimate);
    </script>
</body>
</html>
